"use strict";(self["webpackChunkvue_proyecto"]=self["webpackChunkvue_proyecto"]||[]).push([[616],{9940:function(r,o,e){e.d(o,{c:function(){return c}});var t=e(4108),s=e(9096);const a={class:"form__error",id:"formError"};function i(r,o,e,i,n,l){return(0,t.Wz)(),(0,t.An)("div",a,[(0,t.QD)("p",null,(0,s.WA)(this.$props.message),1)])}var n={props:{message:{type:String,required:!1}}},l=e(4100);const m=(0,l.c)(n,[["render",i]]);var c=m},7616:function(r,o,e){e.r(o),e.d(o,{default:function(){return w}});var t=e(4108),s=e(7764);const a={class:"form__container"},i=(0,t.QD)("h2",null,"Iniciar sesi칩n",-1),n={class:"form__row",id:"formEmailContainer"},l=(0,t.QD)("div",{class:"form__column__small"},[(0,t.QD)("label",{for:"formEmail",class:"form__label"},"Email")],-1),m={class:"form__column__big"},c={class:"form__row"},f=(0,t.QD)("div",{class:"form__column__small"},[(0,t.QD)("label",{for:"formPassword",class:"form__label"},"Contrase침a")],-1),u={class:"form__column__big"},d={class:"form__row"};function p(r,o,e,p,_,h){return(0,t.Wz)(),(0,t.An)("section",a,[i,(0,t.QD)("form",{onSubmit:o[5]||(o[5]=(0,s.Y7)(((...r)=>h.login&&h.login(...r)),["prevent"])),class:"form"},[(0,t.QD)("fieldset",n,[l,(0,t.QD)("div",m,[(0,t.wt)((0,t.QD)("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=r=>_.formEmail=r),id:"formEmail",name:"email",ref:"formEmail",class:"form__input",onBlur:o[1]||(o[1]=r=>h.validateField(this.$refs.formEmail))},null,544),[[s.Og,_.formEmail]])])]),(0,t.QD)("fieldset",c,[f,(0,t.QD)("div",u,[(0,t.wt)((0,t.QD)("input",{type:"password","onUpdate:modelValue":o[2]||(o[2]=r=>_.formPassword=r),id:"formPassword",name:"contrase침a",ref:"formPassword",class:"form__input",onBlur:o[3]||(o[3]=r=>h.validateField(this.$refs.formPassword))},null,544),[[s.Og,_.formPassword]])])]),(0,t.QD)("fieldset",d,[(0,t.QD)("button",{onSubmit:o[4]||(o[4]=(...r)=>h.login&&h.login(...r)),class:"form__button",ref:"submitButton",disabled:""},"Login",544)])],32)])}e(3248);var _=e(3220),h=e(9940);const v=(0,_.I)(["token"]);var E={data(){return{formEmail:"",formPassword:""}},methods:{async login(){const r=await fetch("http://localhost:8000/api/login",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:this.formEmail,password:this.formPassword})}),o=await r.json();200===o.statusCode?(v.set("token",o.token,{maxAge:86400,sameSite:"strict",path:"/"}),this.$router.push("/profile")):this.createLoginError()},validateField(r){const o=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;""!==r.value?"email"!==r.name||r.value.toLowerCase().match(o)?(this.removeFormError(),this.changeSubmitButton(o)):this.createFormError(`Error, el campo ${r.name} debe contener un email v치lido`,r.parentElement):this.createFormError(`Error, el campo ${r.name} debe tener un valor`,r.parentElement)},createLoginError(){const r=(0,t.h)(h.c,{message:"Error de login, credenciales incorrectas"});(0,s.ai)(r,this.$el)},createFormError(r,o){this.$refs.submitButton.setAttribute("disabled",!0);const e=(0,t.h)(h.c,{message:r});(0,s.ai)(e,o)},removeFormError(){const r=document.querySelectorAll("#formError");r.forEach((r=>{r.remove()}))},changeSubmitButton(r){""!==this.$refs.formEmail.value&&this.$refs.formEmail.value.toLowerCase().match(r)&&""!==this.$refs.formPassword.value&&this.$refs.submitButton.removeAttribute("disabled")}}},b=e(4100);const g=(0,b.c)(E,[["render",p]]);var w=g}}]);
//# sourceMappingURL=616.6dbd4f77.js.map